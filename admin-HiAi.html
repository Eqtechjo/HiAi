<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>HiAi Admin Panel - Add Product</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      padding: 20px;
    }
    input, textarea, button {
      display: block;
      margin-bottom: 15px;
      width: 100%;
      max-width: 400px;
      padding: 10px;
    }
    .success {
      color: green;
    }
    .error {
      color: red;
    }
  </style>
</head>
<body>

  <h1>Add Product</h1>

  <input type="text" id="name" placeholder="Product Name" required />
  <textarea id="description" placeholder="Product Description" required></textarea>
  
  <label>Select Image:</label>
  <input type="file" id="image" accept="image/*" required />

  <label>Select PDF:</label>
  <input type="file" id="pdf" accept="application/pdf" required />

  <button onclick="submitProduct()">Submit</button>

  <p id="message"></p>

  <script>
    async function readFileAsBase64(file) {
      return new Promise((resolve, reject) => {
        const reader = new FileReader();
        reader.onload = () => resolve(reader.result);
        reader.onerror = error => reject(error);
        reader.readAsDataURL(file);
      });
    }

    async function submitProduct() {
      const name = document.getElementById("name").value.trim();
      const description = document.getElementById("description").value.trim();
      const imageFile = document.getElementById("image").files[0];
      const pdfFile = document.getElementById("pdf").files[0];
      const message = document.getElementById("message");

      if (!name || !description || !imageFile || !pdfFile) {
        message.textContent = "Please fill in all fields.";
        message.className = "error";
        return;
      }

      try {
        const imageData = await readFileAsBase64(imageFile);
        const pdfData = await readFileAsBase64(pdfFile);

        const payload = {
          sheet1: {
            name: name,
            description: description,
            image: imageData,
            pdf: pdfData
          }
        };

        const response = await fetch("https://api.sheety.co/7a96066cfa7bed25dc8b7979487254db/products/sheet1", {
          method: "POST",
          headers: {
            "Content-Type": "application/json"
          },
          body: JSON.stringify(payload)
        });

        if (!response.ok) throw new Error("Failed to save.");

        message.textContent = "✅ Product saved successfully!";
        message.className = "success";

        document.getElementById("name").value = "";
        document.getElementById("description").value = "";
        document.getElementById("image").value = "";
        document.getElementById("pdf").value = "";

      } catch (error) {
        console.error(error);
        message.textContent = "❌ Failed to save. Please try again.";
        message.className = "error";
      }
    }
  </script>

</body>
</html>
